(window.webpackJsonp=window.webpackJsonp||[]).push([[191],{519:function(s,a,e){"use strict";e.r(a);var n=e(4),t=Object(n.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"free"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#free"}},[s._v("#")]),s._v(" free")]),s._v(" "),a("p",[s._v("显示内存的使用情况")]),s._v(" "),a("h2",{attrs:{id:"补充说明"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#补充说明"}},[s._v("#")]),s._v(" 补充说明")]),s._v(" "),a("p",[a("strong",[s._v("free命令")]),s._v(" 可以显示当前系统未使用的和已使用的内存数目，还可以显示被内核使用的内存缓冲区。")]),s._v(" "),a("h3",{attrs:{id:"语法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#语法"}},[s._v("#")]),s._v(" 语法")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("free"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("选项"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"选项"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#选项"}},[s._v("#")]),s._v(" 选项")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-b")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 以Byte为单位显示内存使用情况；")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-k")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 以KB为单位显示内存使用情况；")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-m")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 以MB为单位显示内存使用情况；")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-g")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 以GB为单位显示内存使用情况。 ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-o")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 不显示缓冲区调节列；")]),s._v("\n-s"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("间隔秒数"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 持续观察内存使用状况；")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-t")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 显示内存总和列；")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-V")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 显示版本信息。")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("h3",{attrs:{id:"实例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#实例"}},[s._v("#")]),s._v(" 实例")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("free")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-t")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 以总和的形式显示内存的使用信息")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("free")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-s")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 周期性的查询内存使用信息，每10s 执行一次命令")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("显示内存使用情况")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("free")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-m")]),s._v("\n             total       used       "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("free")]),s._v("     shared    buffers     cached\nMem:          "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2016")]),s._v("       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1973")]),s._v("         "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("42")]),s._v("          "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("163")]),s._v("       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1497")]),s._v("\n-/+ buffers/cache:        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("312")]),s._v("       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1703")]),s._v("\nSwap:         "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4094")]),s._v("          "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4094")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("p",[a("strong",[s._v("第一部分Mem行解释：")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("total：内存总数；\nused：已经使用的内存数；\nfree：空闲的内存数；\nshared：当前已经废弃不用；\nbuffers Buffer：缓存内存数；\ncached Page：缓存内存数。\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[s._v("关系：total = used + free")]),s._v(" "),a("p",[a("strong",[s._v("第二部分(-/+ buffers/cache)解释:")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("-buffers/cache"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" used内存数：第一部分Mem行中的 used – buffers – cached\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("+buffers/cache"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" free内存数: 第一部分Mem行中的 "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("free")]),s._v(" + buffers + cached\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("可见-buffers/cache反映的是被程序实实在在吃掉的内存，而+buffers/cache反映的是可以挪用的内存总数。")]),s._v(" "),a("p",[s._v("第三部分是指交换分区。")]),s._v(" "),a("p",[s._v("输出结果的第四行是交换分区SWAP的，也就是我们通常所说的虚拟内存。\n区别：第二行(mem)的used/free与第三行(-/+ buffers/cache) used/free的区别。 这两个的区别在于使用的角度来看，第一行是从OS的角度来看，因为对于OS，buffers/cached 都是属于被使用，所以他的可用内存是2098428KB,已用内存是30841684KB,其中包括，内核（OS）使用+Application(X, oracle,etc)使用的+buffers+cached.")]),s._v(" "),a("p",[s._v("第三行所指的是从应用程序角度来看，对于应用程序来说，buffers/cached 是等于可用的，因为buffer/cached是为了提高文件读取的性能，当应用程序需在用到内存的时候，buffer/cached会很快地被回收。")]),s._v(" "),a("p",[s._v("所以从应用程序的角度来说，可用内存=系统free memory+buffers+cached。\n如本机情况的可用内存为：")]),s._v(" "),a("p",[s._v("18007156=2098428KB+4545340KB+11363424KB")]),s._v(" "),a("p",[s._v("接下来解释什么时候内存会被交换，以及按什么方交换。")]),s._v(" "),a("p",[s._v("当可用内存少于额定值的时候，就会开会进行交换。如何看额定值：")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" /proc/meminfo\n\nMemTotal:       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16140816")]),s._v(" kB\nMemFree:          "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("816004")]),s._v(" kB\nMemAvailable:    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2913824")]),s._v(" kB\nBuffers:           "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("17912")]),s._v(" kB\nCached:          "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2239076")]),s._v(" kB\nSwapCached:            "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" kB\nActive:         "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("12774804")]),s._v(" kB\nInactive:        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1594328")]),s._v(" kB\nActive"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("anon"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(":   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("12085544")]),s._v(" kB\nInactive"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("anon"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(":    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("94572")]),s._v(" kB\nActive"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("file"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(":     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("689260")]),s._v(" kB\nInactive"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("file"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(":  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1499756")]),s._v(" kB\nUnevictable:      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("116888")]),s._v(" kB\nMlocked:          "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("116888")]),s._v(" kB\nSwapTotal:       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8191996")]),s._v(" kB\nSwapFree:        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8191996")]),s._v(" kB\nDirty:                "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("56")]),s._v(" kB\nWriteback:             "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" kB\nAnonPages:      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("12229228")]),s._v(" kB\nMapped:           "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("117136")]),s._v(" kB\nShmem:             "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("58736")]),s._v(" kB\nSlab:             "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("395568")]),s._v(" kB\nSReclaimable:     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("246700")]),s._v(" kB\nSUnreclaim:       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("148868")]),s._v(" kB\nKernelStack:       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("30496")]),s._v(" kB\nPageTables:       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("165104")]),s._v(" kB\nNFS_Unstable:          "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" kB\nBounce:                "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" kB\nWritebackTmp:          "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" kB\nCommitLimit:    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16262404")]),s._v(" kB\nCommitted_AS:   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("27698600")]),s._v(" kB\nVmallocTotal:   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("34359738367")]),s._v(" kB\nVmallocUsed:      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("311072")]),s._v(" kB\nVmallocChunk:   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("34350899200")]),s._v(" kB\nHardwareCorrupted:     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" kB\nAnonHugePages:   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3104768")]),s._v(" kB\nHugePages_Total:       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\nHugePages_Free:        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\nHugePages_Rsvd:        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\nHugePages_Surp:        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\nHugepagesize:       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2048")]),s._v(" kB\nDirectMap4k:      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("225536")]),s._v(" kB\nDirectMap2M:    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("13279232")]),s._v(" kB\nDirectMap1G:     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5242880")]),s._v(" kB\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br")])]),a("p",[s._v("交换将通过三个途径来减少系统中使用的物理页面的个数：")]),s._v(" "),a("ol",[a("li",[s._v("减少缓冲与页面cache的大小，")]),s._v(" "),a("li",[s._v("将系统V类型的内存页面交换出去，")]),s._v(" "),a("li",[s._v("换出或者丢弃页面。(Application 占用的内存页，也就是物理内存不足）。")])]),s._v(" "),a("p",[s._v("事实上，少量地使用swap是不是影响到系统性能的。")]),s._v(" "),a("p",[s._v("那buffers和cached都是缓存，两者有什么区别呢？")]),s._v(" "),a("p",[s._v("为了提高磁盘存取效率, Linux做了一些精心的设计, 除了对dentry进行缓存(用于VFS,加速文件路径名到inode的转换), 还采取了两种主要Cache方式：")]),s._v(" "),a("p",[s._v("Buffer Cache和Page Cache。前者针对磁盘块的读写，后者针对文件inode的读写。这些Cache有效缩短了 I/O系统调用(比如read,write,getdents)的时间。\n磁盘的操作有逻辑级（文件系统）和物理级（磁盘块），这两种Cache就是分别缓存逻辑和物理级数据的。")]),s._v(" "),a("p",[s._v("Page cache实际上是针对文件系统的，是文件的缓存，在文件层面上的数据会缓存到page cache。文件的逻辑层需要映射到实际的物理磁盘，这种映射关系由文件系统来完成。当page cache的数据需要刷新时，page cache中的数据交给buffer cache，因为Buffer Cache就是缓存磁盘块的。但是这种处理在2.6版本的内核之后就变的很简单了，没有真正意义上的cache操作。")]),s._v(" "),a("p",[s._v("Buffer cache是针对磁盘块的缓存，也就是在没有文件系统的情况下，直接对磁盘进行操作的数据会缓存到buffer cache中，例如，文件系统的元数据都会缓存到buffer cache中。")]),s._v(" "),a("p",[s._v("简单说来，page cache用来缓存文件数据，buffer cache用来缓存磁盘数据。在有文件系统的情况下，对文件操作，那么数据会缓存到page cache，如果直接采用dd等工具对磁盘进行读写，那么数据会缓存到buffer cache。")]),s._v(" "),a("p",[s._v("所以我们看linux,只要不用swap的交换空间,就不用担心自己的内存太少.如果常常swap用很多,可能你就要考虑加物理内存了.这也是linux看内存是否够用的标准.")]),s._v(" "),a("p",[s._v("如果是应用服务器的话，一般只看第二行，+buffers/cache,即对应用程序来说free的内存太少了，也是该考虑优化程序或加内存了。")])])}),[],!1,null,null,null);a.default=t.exports}}]);