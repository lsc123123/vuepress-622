(window.webpackJsonp=window.webpackJsonp||[]).push([[500],{827:function(s,a,t){"use strict";t.r(a);var e=t(4),n=Object(e.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"smartmontools"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#smartmontools"}},[s._v("#")]),s._v(" smartmontools")]),s._v(" "),a("p",[s._v("Smartmontools 是一种硬盘检测工具，通过控制和管理硬盘的SMART（Self Monitoring Analysis and Reporting Technology，自动检测分析及报告技术）技术来实现的")]),s._v(" "),a("p",[s._v("##安装")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("aptitude")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" smartmontools\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h2",{attrs:{id:"语法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#语法"}},[s._v("#")]),s._v(" 语法")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("smartctl "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("选项"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("参数"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h2",{attrs:{id:"选项"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#选项"}},[s._v("#")]),s._v(" 选项")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-i")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("硬盘"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" 显示硬盘设备的标识信息\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-a")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("硬盘"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" 显示设备的所有SMART信息\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-H")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("硬盘"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" 显示设备的健康信息\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-A")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("硬盘"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" 显示设备SMART供应商特定的属性和值\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("h2",{attrs:{id:"参数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参数"}},[s._v("#")]),s._v(" 参数")]),s._v(" "),a("p",[s._v("硬盘设备：指定要查看的硬盘(可以使用 fdisk -l 获取有哪些硬盘设备)")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("~ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("fdisk")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-l")]),s._v("\n设备          起点      末尾      扇区   大小 类型\n/dev/sda1     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2048")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1050623")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1048576")]),s._v("   512M EFI 系统\n/dev/sda2  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1050624")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("976771071")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("975720448")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("465")]),s._v(".3G Linux 文件系统\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("h2",{attrs:{id:"实例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#实例"}},[s._v("#")]),s._v(" 实例")]),s._v(" "),a("p",[s._v('查看 /dev/sda1 硬盘的健康状态，在这个命令中，"-s on"标志开启指定设备上的SMART功能。如果/dev/sda上已开启SMART支持，那就省略它。'),a("br"),s._v("\n（PASSED 表示健康；FAILED 表示即将出现故障所以需要开始备份这块磁盘上的重要数据）")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("~ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" smartctl "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-s")]),s._v(" on "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-H")]),s._v(" /dev/sda1   \n\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" START OF READ SMART DATA SECTION "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("\nSMART overall-health self-assessment "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v(" result: PASSED\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("查看 /dev/sda1 硬盘特定的属性和值\n(Power_On_Hours: 表示通电时长 18195 小时)")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("~ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" smartctl "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-A")]),s._v(" /dev/sda1\n\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" START OF READ SMART DATA SECTION "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("\nSMART Attributes Data Structure revision number: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v("\nVendor Specific SMART Attributes with Thresholds:\nID"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ATTRIBUTE_NAME          FLAG     VALUE WORST THRESH TYPE      UPDATED  WHEN_FAILED RAW_VALUE")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" Spin_Up_Time            0x0023   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("   002    Pre-fail  Always       -       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1326")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" Start_Stop_Count        0x0032   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("   000    Old_age   Always       -       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3752")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v(" Power_On_Hours          0x0032   055   055   000    Old_age   Always       -       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("18195")]),s._v("\n "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(" Spin_Retry_Count        0x0033   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("174")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("   030    Pre-fail  Always       -       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(" Power_Cycle_Count       0x0032   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("   000    Old_age   Always       -       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3118")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("183")]),s._v(" Runtime_Bad_Block       0x0032   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("   001    Old_age   Always       -       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("184")]),s._v(" End-to-End_Error        0x0033   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("   097    Pre-fail  Always       -       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("185")]),s._v(" Unknown_Attribute       0x0032   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("   001    Old_age   Always       -       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("65535")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("187")]),s._v(" Reported_Uncorrect      0x0032   001   001   000    Old_age   Always       -       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("134")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("188")]),s._v(" Command_Timeout         0x0032   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("   098   000    Old_age   Always       -       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("48")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("191")]),s._v(" G-Sense_Error_Rate      0x0032   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("   000    Old_age   Always       -       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2850")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192")]),s._v(" Power-Off_Retract_Count 0x0022   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("   000    Old_age   Always       -       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("32047593")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("193")]),s._v(" Load_Cycle_Count        0x0032   095   095   000    Old_age   Always       -       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("51738")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("194")]),s._v(" Temperature_Celsius     0x0022   060   055   040    Old_age   Always       -       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("40")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Min/Max "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v("/44"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br")])]),a("h3",{attrs:{id:"以指定的间隔运行-同时又能通知硬盘的测试结果"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#以指定的间隔运行-同时又能通知硬盘的测试结果"}},[s._v("#")]),s._v(" 以指定的间隔运行，同时又能通知硬盘的测试结果")]),s._v(" "),a("p",[s._v("首先，编辑smartctl的配置文件(/etc/default/smartmontools)以便在系统启动时启动smartd，并以秒为单位指定间隔时间（如7200 = 2小时）")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("start_smartd")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("yes\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("smartd_opts")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"--interval=7200"')]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("下一步，编辑smartd的配置文件（/etc/smartd.conf），添加以下行内容。")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("/dev/sda "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-m")]),s._v(" myemail@mydomain.com "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-M")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("选项说明 "),a("br"),s._v("\n-m ：指定发送测试报告到某个电子邮件地址。这里可以是系统用户比如root，或者如果服务器已经配置成发送电子邮件到系统外部，则是类似于 myemail@mydomain.com 的邮件地址。"),a("br"),s._v("\n-M ：指定发送邮件报告的期望类型。"),a("br"),s._v("\nonce：为检测到的每种磁盘问题只发送一封警告邮件。"),a("br"),s._v("\ndaily：为检测到的每种磁盘问题每隔一天发送一封额外的警告提醒邮件。"),a("br"),s._v("\ndiminishing：为检测到的每种问题发送一封额外的警告提醒邮件，开始是每隔一天，然后每隔两天，每隔四天，以此类推。每个间隔是前一次间隔的2倍。"),a("br"),s._v("\ntest：只要smartd一启动，立即发送一封测试邮件。"),a("br"),s._v("\nexec PATH：取代默认的邮件命令，运行PATH路径下的可执行文件。PATH必须指向一个可执行的二进制文件或脚本。当检测到一个问题时，可以指定执行一个期望的动作（闪烁控制台、关闭系统等等）。")]),s._v(" "),a("p",[s._v("保存改动并重启smartd。")])])}),[],!1,null,null,null);a.default=n.exports}}]);